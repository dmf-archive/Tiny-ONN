# F3EO 备选 L_meta 候选列表

> 基于 AdaFisher (ICLR 2025) 的块对角 Fisher 信息矩阵 ℱ_block，我们提出以下 5 个可计算的元损失候选，供会议前评估。

---

## 候选 1：迹最小化 (Trace Minimization)

**公式**：  
L_meta = Tr(ℱ_block)

**理论依据**：  
Fisher 矩阵的迹是模型复杂度的一阶标量度量。最小化迹直接压缩参数空间的有效维度，迫使模型走向更简约的表示。

**可计算性**：  
✅ 极低代价 —— 对 AdaFisher 已有的 `H_D` 与 `S_D` 求和即可：  
Tr(ℱ_l) = ‖H_D‖₁ · ‖S_D‖₁  
无需额外矩阵操作。

**梯度**：  
∇_θ Tr(ℱ_block) 可通过一次 `torch.autograd.grad` 获得，复杂度 O(N²)。

---

## 候选 2：对数行列式 (Log-Determinant)

**公式**：  
L_meta = log |ℱ_block|

**理论依据**：  
log|ℱ| 是模型体积的度量，与 MDL 原则直接相关。最小化它等价于最小化模型编码长度，实现“最简解释”。

**可计算性**：  
⚠️ 需对每层块 `ℱ_l` 做 Cholesky 分解，复杂度 O(∑_l d_l³)。  
AdaFisher 已保证 ℱ_l 正定（+Λ 正则），数值稳定。

**梯度**：  
已知  
∇_θ log|ℱ| = ℱ⁻¹ ∇_θ ℱ  
可利用 AdaFisher 的 `F_tilde` 直接求逆，再与 `∇_θ ℱ` 做内积。

---

## 候选 3：Frobenius 范数 (Frobenius Norm)

**公式**：  
L_meta = ‖ℱ_block‖_F²

**理论依据**：  
惩罚 Fisher 块的总能量，抑制“过大”的曲率方向，使优化 landscape 更均匀。

**可计算性**：  
✅ 只需对 `H_D`, `S_D` 做逐元素平方和，无需分解。  
复杂度 O(N)。

**梯度**：  
∇_θ ‖ℱ‖_F² = 2 ℱ ⊙ ∇_θ ℱ，逐元素乘法即可。

---

## 候选 4：条件数惩罚 (Condition-Number Penalty)

**公式**：  
L_meta = λ₁ / λ_min(ℱ_block)

**理论依据**：  
显式惩罚病态条件数，迫使 Fisher 块趋向良态，提升自然梯度稳定性。

**可计算性**：  
⚠️ 需计算每层最小特征值 λ_min，可用幂法或 Lanczos，复杂度 O(k·N²)（k 为迭代次数）。

**梯度**：  
需通过隐式微分求解 λ_min 对 θ 的梯度，实现稍复杂。

---

## 候选 5：谱半径约束 (Spectral Radius)

**公式**：  
L_meta = ρ(ℱ_block) = max |eig(ℱ_block)|

**理论依据**：  
限制 Fisher 块的谱半径，间接控制参数更新的最大步长，防止“爆炸式”自然梯度。

**可计算性**：  
⚠️ 与候选 4 类似，需幂法求最大特征值，复杂度 O(k·N²)。

**梯度**：  
同样需隐式微分，代码量高于候选 1-3。

---

## 会议评估维度建议

1. **理论优雅性**（与 FEP/MDL 的契合度）
2. **数值稳定性**（是否依赖分解/迭代）
3. **计算开销**（是否可每步调用）
4. **实现复杂度**（梯度是否易求）
5. **实证可调性**（超参数多少）

> 推荐顺序：1 → 3 → 2 → 5 → 4  
> 即：先实现“迹”与“Frobenius”作为 baseline，再逐步升级至“对数行列式”与谱相关目标。
